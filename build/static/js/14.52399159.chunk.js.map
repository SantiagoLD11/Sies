{"version":3,"sources":["views/ReportNotasAdmin.jsx"],"names":["require","ReportNotasAdmin","_useState","useState","_useState2","_slicedToArray","data","setData","_useState3","_useState4","loading","setLoading","_useState5","_useState6","tableResults","setTableResults","onSubmit","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","resp","wrap","_context","prev","next","getReportNotasAdmin","sent","convertirStringArreglo","stop","apply","arguments","useEffect","numeros","tResultados","split","array","i","length","dataElement","objeto","mesYear","servicio","resultado","push","columns","title","_jsx","style","backgroundColor","color","children","dataIndex","key","render","text","forEach","index","concat","console","log","_jsxs","_Fragment","className","display","justifyContent","padding","marginBottom","Button","onClick","wb","Sheets","XLSX","json_to_sheet","SheetNames","excelBuffer","bookType","type","date","Date","stringDate","getDay","getMonth","getFullYear","excelFile","Blob","saveAs","CloudDownloadOutlined","ReloadOutlined","Card","zIndex","Table","dataSource","scroll","x"],"mappings":"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","file":"static/js/14.52399159.chunk.js","sourcesContent":["import { Card, Table, Button } from \"antd\";\r\nimport { React, useEffect, useState } from \"react\";\r\nimport { CloudDownloadOutlined,ReloadOutlined } from \"@ant-design/icons\";\r\nimport * as XLSX from 'xlsx';\r\nimport { saveAs } from 'file-saver';\r\nimport {\r\n  getReportNotasAdmin\r\n} from \"../appRedux/services\";\r\nimport moment from \"moment\";\r\nrequire(\"moment-timezone\");\r\n\r\nconst ReportNotasAdmin = () => {\r\n  const [data, setData] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [tableResults,setTableResults] = useState([]);\r\n\r\n  const onSubmit = async () => {\r\n    setLoading(true);\r\n    const resp = await getReportNotasAdmin();\r\n    convertirStringArreglo();\r\n    setLoading(false);\r\n    setData(resp);\r\n  };\r\n\r\n  useEffect(() => {\r\n    onSubmit();\r\n  }, []);\r\n\r\n  const convertirStringArreglo = () => {\r\n    const numeros = data.tResultados.split(\",\");\r\n    const array = [];\r\n\r\n    for (let i = 0; i < numeros.length; i += 2) {\r\n      \r\n      const dataElement = numeros[i].split(\"-\");\r\n      const my = dataElement[0];\r\n      const servicio = dataElement[1];\r\n      const resultado = numeros[i + 1];\r\n      const objeto = { mesYear: my,servicio: servicio, resultado: resultado };\r\n      array.push(objeto);\r\n    }\r\n\r\n    setTableResults(array);\r\n  };\r\n\r\n  const columns = [\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Documento\r\n        </span>\r\n      ),\r\n      dataIndex: \"secuen\",\r\n      key: \"secuen\",\r\n      render: (text) => <strong>{text}</strong>,\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Programa\r\n        </span>\r\n      ),\r\n      dataIndex: \"programa\",\r\n      key: \"programa\",\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Fecha Registro\r\n        </span>\r\n      ),\r\n      dataIndex: \"fechaHoraRegistro\",\r\n      key: \"fechaHoraRegistro\",\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Responsable\r\n        </span>\r\n      ),\r\n      dataIndex: \"createdBy\",\r\n      key: \"createdBy\",\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Etiqueta Administrativa\r\n        </span>\r\n      ),\r\n      dataIndex: \"etAdmin\",\r\n      key: \"etAdmin\",\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Observacion Etiqueta Administrativa\r\n        </span>\r\n      ),\r\n      dataIndex: \"noteChange\",\r\n      key: \"noteChange\",\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Etiqueta Seguimiento\r\n        </span>\r\n      ),\r\n      dataIndex: \"etSeguimiento\",\r\n      key: \"etSeguimiento\",\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Observacion Seguimiento\r\n        </span>\r\n      ),\r\n      dataIndex: \"observacion_Seguimiento\",\r\n      key: \"observacion_Seguimiento\",\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Motivo Inasistencia\r\n        </span>\r\n      ),\r\n      dataIndex: \"motInasis\",\r\n      key: \"motInasis\",\r\n    }\r\n  ];\r\n\r\n  // Bucle para agregar las columnas repetitivas\r\n  tableResults.forEach((objeto, index) => {\r\n  columns.push(\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          {`Mes/Año Plan Mensual #${index + 1}`}\r\n        </span>\r\n      ),\r\n      dataIndex: `mesYear_${index}`,\r\n      key: `mesYear_${index}`,\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          {`Servicio/Plan Mensual #${index + 1}`}\r\n        </span>\r\n      ),\r\n      dataIndex: `servicio_${index}`,\r\n      key: `servicio_${index}`,\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          {`Resultado de Contacto #${index + 1}`}\r\n        </span>\r\n      ),\r\n      dataIndex: `resultado_${index}`,\r\n      key: `resultado_${index}`,\r\n      render: (text) => text, // Puedes aplicar el renderizado que necesites aquí\r\n    }\r\n  );\r\n});\r\n\r\n// Mostrar el resultado\r\nconsole.log(columns);\r\n\r\n  const downloadExcel = () => {\r\n    const fileType = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8';\r\n    const fileExtension = '.xlsx';\r\n\r\n    const ws = XLSX.utils.json_to_sheet(data);\r\n    const wb = { Sheets: { 'data': ws }, SheetNames: ['data'] };\r\n    const excelBuffer = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });\r\n\r\n    const date = new Date();\r\n\r\n    const stringDate = date.getDay() +'/'+ (date.getMonth()+1) +\"/\"+ date.getFullYear();\r\n\r\n    const excelFile = new Blob([excelBuffer], { type: fileType });\r\n    saveAs(excelFile, `Informe Pacientes-${stringDate}` + fileExtension);\r\n  };\r\n\r\n\r\n  return (\r\n    <>\r\n      <div\r\n        className=\"gx-profile-banner\"\r\n        style={{\r\n          display: \"flex\",\r\n          justifyContent: \"space-between\",\r\n          padding: \"32px 32px 70px\",\r\n        }}\r\n      >\r\n        <div className=\"gx-profile-container\">\r\n          <div\r\n            className=\"gx-profile-banner-top\"\r\n            style={{ justifyContent: \"space-between\", marginBottom: \"10px\" }}\r\n          >\r\n            <Button onClick={downloadExcel} \r\n            style={{ backgroundColor: \"#484d55\", color: \"#FFF\" }}> \r\n            <CloudDownloadOutlined />             \r\n              Descargar Excel\r\n            </Button>\r\n\r\n            <Button onClick={onSubmit}>    \r\n            <ReloadOutlined />          \r\n              Actualizar\r\n            </Button>\r\n          </div>\r\n\r\n        </div>\r\n      </div>\r\n\r\n      <Card style={{ zIndex: 2 }}>\r\n        <Table\r\n          columns={columns}\r\n          loading={loading}\r\n          dataSource={data}\r\n          scroll={{ x: 1300 }}\r\n        />\r\n      </Card>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ReportNotasAdmin;\r\n"],"sourceRoot":""}