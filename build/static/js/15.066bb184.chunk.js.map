{"version":3,"sources":["views/ReportAgendamiento.jsx"],"names":["require","ReportAgendamiento","_useState","useState","_useState2","_slicedToArray","data","setData","_useState3","_useState4","loading","setLoading","onSubmit","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","resp","wrap","_context","prev","next","getReportAgendamiento","sent","console","log","t0","error","stop","apply","arguments","useEffect","fetchData","_ref2","_callee2","_context2","renderTextOrEmpty","text","undefined","_jsx","children","columns","title","style","backgroundColor","color","dataIndex","key","render","moment","format","isValid","record","_jsxs","_Fragment","className","display","justifyContent","padding","marginBottom","Button","onClick","wb","Sheets","XLSX","json_to_sheet","SheetNames","excelBuffer","bookType","type","date","Date","stringDate","getDay","getMonth","getFullYear","excelFile","Blob","saveAs","concat","CloudDownloadOutlined","ReloadOutlined","Card","zIndex","Table","dataSource","scroll","x"],"mappings":"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","file":"static/js/15.066bb184.chunk.js","sourcesContent":["import { Card, Table, Button } from \"antd\";\r\nimport { React, useEffect, useState } from \"react\";\r\nimport { CloudDownloadOutlined, ReloadOutlined } from \"@ant-design/icons\";\r\nimport * as XLSX from 'xlsx';\r\nimport { saveAs } from 'file-saver';\r\nimport {\r\n  getReportAgendamiento\r\n} from \"../appRedux/services\";\r\nimport moment from \"moment\";\r\nrequire(\"moment-timezone\");\r\n\r\nconst ReportAgendamiento = () => {\r\n  const [data, setData] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const onSubmit = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const resp = await getReportAgendamiento();\r\n      console.log('Respuesta de getReport:', resp); // Verifica la respuesta recibida\r\n      setData(resp);\r\n      setLoading(false);\r\n    } catch (error) {\r\n      console.error('Error al obtener los datos:', error);\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      setLoading(true);\r\n      try {\r\n        const resp = await getReportAgendamiento();\r\n        console.log('Respuesta de getReport:', resp); // Verifica la respuesta recibida\r\n        setData(resp);\r\n        setLoading(false);\r\n      } catch (error) {\r\n        console.error('Error al obtener los datos:', error);\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, []);\r\n\r\n  const renderState = (state) => {\r\n    let renderedText = \"\";\r\n    switch (state) {\r\n      case 1:\r\n        renderedText = \"Disponible\";\r\n        break;\r\n      case 2:\r\n        renderedText = \"Bloqueado\";\r\n        break;\r\n      case 3:\r\n        renderedText = \"Asignado Cita\";\r\n        break;\r\n      default:\r\n        renderedText = \"Desconocido\";\r\n        break;\r\n    }\r\n    return renderedText;\r\n  };\r\n\r\n  const calculateDaysDifference = (createdAt, fechaDisponibilidad) => {\r\n    const createdDate = moment(createdAt);\r\n    const availabilityDate = moment(fechaDisponibilidad);\r\n    const differenceInDays = availabilityDate.diff(createdDate, \"days\");\r\n    return differenceInDays;\r\n  };\r\n\r\n  const renderTextOrEmpty = (text) => {\r\n    if (text === null || text === undefined || text === '') {\r\n      return <strong>Sin información</strong>;\r\n    }\r\n    return {text};\r\n  };\r\n\r\n\r\n  const columns = [\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Documento Paciente\r\n        </span>\r\n      ),\r\n      dataIndex: \"numDocPac\",\r\n      key: \"numDocPac\",\r\n      render: (text) => renderTextOrEmpty(text),\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Nombre Paciente\r\n        </span>\r\n      ),\r\n      dataIndex: \"namePac\",\r\n      key: \"namePac\",\r\n      render: (text) => renderTextOrEmpty(text),\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Nombre Profesional\r\n        </span>\r\n      ),\r\n      dataIndex: \"nameProf\",\r\n      key: \"nameProf\",\r\n      render: (text) => renderTextOrEmpty(text),\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Documento Profesional\r\n        </span>\r\n      ),\r\n      dataIndex: \"numDocProf\",\r\n      key: \"numDocProf\",\r\n      render: (text) => renderTextOrEmpty(text),\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Fecha Cita\r\n        </span>\r\n      ),\r\n      dataIndex: \"dateCita\",\r\n      key: \"dateCita\",\r\n      render: (text) => <strong>{moment(text).format(\"DD/MM/YYYY\")}</strong>,\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Hora Cita\r\n        </span>\r\n      ),\r\n      dataIndex: \"dateCita\",\r\n      key: \"dateCita\",\r\n      render: (text) => <strong>{moment(text).format(\"HH:mm a\")}</strong>,\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Examen\r\n        </span>\r\n      ),\r\n      dataIndex: \"nameExam\",\r\n      key: \"nameExam\",\r\n      render: (text) => renderTextOrEmpty(text),\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Estado\r\n        </span>\r\n      ),\r\n      dataIndex: \"state\",\r\n      key: \"state\",\r\n      render: (text) => renderTextOrEmpty(text),\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Creado Por\r\n        </span>\r\n      ),\r\n      dataIndex: \"createdBy\",\r\n      key: \"createdBy\",\r\n      render: (text) => renderTextOrEmpty(text),\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>  \r\n         Fecha/Hora Creacion\r\n        </span>\r\n      ),\r\n      dataIndex: \"createdAt\",\r\n      key: \"createdAt\",\r\n      render: (text) => {\r\n        if (text && moment(text).isValid()) {\r\n          return <strong>{moment(text).format(\"DD/MM/YYYY HH:mm a\")}</strong>;\r\n        } else {\r\n          return <strong>Sin Informacion</strong>;\r\n        }\r\n      },\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Cancelado Por\r\n        </span>\r\n      ),\r\n      dataIndex: \"cancelBy\",\r\n      key: \"cancelBy\",\r\n      render: (text) => renderTextOrEmpty(text),\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Fecha/Hora Cancelacion\r\n        </span>\r\n      ),\r\n      dataIndex: \"dateCancel\",\r\n      key: \"dateCancel\",\r\n      render: (text) => {\r\n        if (text && moment(text).isValid()) {\r\n          return <strong>{moment(text).format(\"DD/MM/YYYY HH:mm a\")}</strong>;\r\n        } else {\r\n          return <strong>Sin Informacion</strong>;\r\n        }\r\n      },\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Motivo Cancelacion\r\n        </span>\r\n      ),\r\n      dataIndex: \"motCancel\",\r\n      key: \"motCancel\",\r\n      render: (text) => renderTextOrEmpty(text),\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Entidad\r\n        </span>\r\n      ),\r\n      dataIndex: \"asegurador\",\r\n      key: \"asegurador\",\r\n      render: (text) => renderTextOrEmpty(text),\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Contrato\r\n        </span>\r\n      ),\r\n      dataIndex: \"codeContrac\",\r\n      key: \"codeContrac\",\r\n      render: (text) => renderTextOrEmpty(text),\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Mes\r\n        </span>\r\n      ),\r\n      dataIndex: \"dateCita\",\r\n      key: \"dateCita\",\r\n      render: (text) => {\r\n        if (text && moment(text).isValid()) {\r\n          return <strong>{moment(text).format(\"MMMM\")}</strong>;\r\n        } else {\r\n          return <strong>Sin Informacion</strong>;\r\n        }\r\n      },\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Franja Horaria\r\n        </span>\r\n      ),\r\n      dataIndex: \"franja\",\r\n      key: \"franja\",\r\n      render: (text) => renderTextOrEmpty(text),\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Dia\r\n        </span>\r\n      ),\r\n      dataIndex: \"dateCita\",\r\n      key: \"dateCita\",\r\n      render: (text) => {\r\n        if (text && moment(text).isValid()) {\r\n          return <strong>{moment(text).format(\"DD\")}</strong>;\r\n        } else {\r\n          return <strong>Sin Informacion</strong>;\r\n        }\r\n      },\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Sede\r\n        </span>\r\n      ),\r\n      dataIndex: \"sede\",\r\n      key: \"sede\",\r\n      render: (text) => renderTextOrEmpty(text),\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Especialidad\r\n        </span>\r\n      ),\r\n      dataIndex: \"profesion\",\r\n      key: \"profesion\",\r\n      render: (text) => renderTextOrEmpty(text),\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Canal\r\n        </span>\r\n      ),\r\n      dataIndex: \"cnlAtencion\",\r\n      key: \"cnlAtencion\",\r\n      render: (text) => renderTextOrEmpty(text),\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Programa\r\n        </span>\r\n      ),\r\n      dataIndex: \"programa\",\r\n      key: \"programa\",\r\n      render: (text) => renderTextOrEmpty(text),\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Asiste Cita\r\n        </span>\r\n      ),\r\n      dataIndex: \"state\",\r\n      key: \"state\",\r\n      render: (text, record) => {\r\n        if (text === 'Asistida') {\r\n          return <strong>Si</strong>;\r\n        } else {\r\n          // Aquí puedes manejar otros estados si es necesario\r\n          return <strong>No</strong>;\r\n        }\r\n      },\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Fecha Ultima Cita\r\n        </span>\r\n      ),\r\n      dataIndex: \"inasisDesc\",\r\n      key: \"inasisDesc\",\r\n      render: (text) => renderTextOrEmpty(text),\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Ultima Atencion Especialidad\r\n        </span>\r\n      ),\r\n      dataIndex: \"inasisDesc\",\r\n      key: \"inasisDesc\",\r\n      render: (text) => renderTextOrEmpty(text),\r\n    },\r\n    {\r\n      title: (\r\n        <span style={{ backgroundColor: \"#184F9D\", color: \"#fff\" }}>\r\n          Soporte Inasistencia\r\n        </span>\r\n      ),\r\n      dataIndex: \"inasisDesc\",\r\n      key: \"inasisDesc\",\r\n      render: (text) => renderTextOrEmpty(text),\r\n    }\r\n  ];\r\n\r\n  const downloadExcel = () => {\r\n    const fileType = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8';\r\n    const fileExtension = '.xlsx';\r\n\r\n    const ws = XLSX.utils.json_to_sheet(data);\r\n    const wb = { Sheets: { 'data': ws }, SheetNames: ['data'] };\r\n    const excelBuffer = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });\r\n\r\n    const date = new Date();\r\n\r\n    const stringDate = date.getDay() + '/' + (date.getMonth() + 1) + \"/\" + date.getFullYear();\r\n\r\n    const excelFile = new Blob([excelBuffer], { type: fileType });\r\n    saveAs(excelFile, `Reporte Agendamiento-${stringDate}` + fileExtension);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div\r\n        className=\"gx-profile-banner\"\r\n        style={{\r\n          display: \"flex\",\r\n          justifyContent: \"space-between\",\r\n          padding: \"32px 32px 70px\",\r\n        }}\r\n      >\r\n        <div className=\"gx-profile-container\">\r\n          <div\r\n            className=\"gx-profile-banner-top\"\r\n            style={{ justifyContent: \"space-between\", marginBottom: \"10px\" }}\r\n          >\r\n            <Button onClick={downloadExcel}\r\n              style={{ backgroundColor: \"#484d55\", color: \"#FFF\" }}>\r\n              <CloudDownloadOutlined />\r\n              Descargar Excel\r\n            </Button>\r\n\r\n            <Button onClick={onSubmit}>\r\n              <ReloadOutlined />\r\n              Actualizar\r\n            </Button>\r\n          </div>\r\n\r\n        </div>\r\n      </div>\r\n\r\n      <Card style={{ zIndex: 2 }}>\r\n        <Table\r\n          columns={columns}\r\n          loading={loading}\r\n          dataSource={data}\r\n          scroll={{ x: 1300 }}\r\n        />\r\n      </Card>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ReportAgendamiento;\r\n"],"sourceRoot":""}